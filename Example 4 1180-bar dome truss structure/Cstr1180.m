function [c,ceq] = Cstr1180(x)
%x=[5.35,	3.4,	26.5938,	8.0668,	3.6831,	2.3176,	21.3495,	10.3539,	6.3859,	4.5076,	13.8374,	10.876,	3.0903,	5.599,	14.2288,	9.8232,	2.9863,	7.6236,	8.6671,	12.1283,	5.1126,	6.4542,	1.2039,	4.2053,	2.2692,	3.1514,	3.9958,	7.6868,	3.3384,	3.4703,	4.498,	8.4914,	6.07,	4.7849,	4.1645,	1.0546,	7.2711,	4.9319,	4.3437,	1.0317,	6.1891,	7.2491,	4.8191,	1,	7.0979,	4.3028,	1.0716]
E = 2e11;     % Young's elastic modulus (kg/m^2)
rho = 7850;   % density of material (kg/m^3)
A = zeros(1,59);       % area of bar (m^2)
A1 = x(1); A2 = x(2); A3 = x(3); A4 = x(4); A5 = x(5); A6 = x(6); A7 = x(7); A8 = x(8); A9 = x(9); A10 = x(10);
A11 = x(11); A12 = x(12); A13 = x(13); A14 = x(14); A15 = x(15); A16 = x(16); A17 = x(17); A18 = x(18); A19 = x(19); A20 = x(20);
A21 = x(21); A22 = x(22); A23 = x(23); A24 = x(24); A25 = x(25); A26 = x(26); A27 = x(27); A28 = x(28); A29 = x(29); A30 = x(30);
A31 = x(31); A32 = x(32); A33 = x(33); A34 = x(34); A35 = x(35); A36 = x(36); A37 = x(37); A38 = x(38); A39 = x(39); A40 = x(40);
A41 = x(41); A42 = x(42); A43 = x(43); A44 = x(44); A45 = x(45); A46 = x(46); A47 = x(47); A48 = x(48); A49 = x(49); A50 = x(50);
A51 = x(51); A52 = x(52); A53 = x(53); A54 = x(54); A55 = x(55); A56 = x(56); A57 = x(57); A58 = x(58); A59 = x(59);

A([1;60;119;178;237;296;355;414;473;532;591;650;709;768;827;886;945;1004;1063;1122])=A1;
A([2;61;120;179;238;297;356;415;474;533;592;651;710;769;828;887;946;1005;1064;1123])=A2;
A([3;62;121;180;239;298;357;416;475;534;593;652;711;770;829;888;947;1006;1065;1124])=A3;
A([4;63;122;181;240;299;358;417;476;535;594;653;712;771;830;889;948;1007;1066;1125])=A4;
A([5;64;123;182;241;300;359;418;477;536;595;654;713;772;831;890;949;1008;1067;1126])=A5;
A([6;65;124;183;242;301;360;419;478;537;596;655;714;773;832;891;950;1009;1068;1127])=A6;
A([7;66;125;184;243;302;361;420;479;538;597;656;715;774;833;892;951;1010;1069;1128])=A7;
A([8;67;126;185;244;303;362;421;480;539;598;657;716;775;834;893;952;1011;1070;1129])=A8;
A([9;68;127;186;245;304;363;422;481;540;599;658;717;776;835;894;953;1012;1071;1130])=A9;
A([10;69;128;187;246;305;364;423;482;541;600;659;718;777;836;895;954;1013;1072;1131])=A10;
A([11;70;129;188;247;306;365;424;483;542;601;660;719;778;837;896;955;1014;1073;1132])=A11;
A([12;71;130;189;248;307;366;425;484;543;602;661;720;779;838;897;956;1015;1074;1133])=A12;
A([13;72;131;190;249;308;367;426;485;544;603;662;721;780;839;898;957;1016;1075;1134])=A13;
A([14;73;132;191;250;309;368;427;486;545;604;663;722;781;840;899;958;1017;1076;1135])=A14;
A([15;74;133;192;251;310;369;428;487;546;605;664;723;782;841;900;959;1018;1077;1136])=A15;
A([16;75;134;193;252;311;370;429;488;547;606;665;724;783;842;901;960;1019;1078;1137])=A16;
A([17;76;135;194;253;312;371;430;489;548;607;666;725;784;843;902;961;1020;1079;1138])=A17;
A([18;77;136;195;254;313;372;431;490;549;608;667;726;785;844;903;962;1021;1080;1139])=A18;
A([19;78;137;196;255;314;373;432;491;550;609;668;727;786;845;904;963;1022;1081;1140])=A19;
A([20;79;138;197;256;315;374;433;492;551;610;669;728;787;846;905;964;1023;1082;1141])=A20;
A([21;80;139;198;257;316;375;434;493;552;611;670;729;788;847;906;965;1024;1083;1142])=A21;
A([22;81;140;199;258;317;376;435;494;553;612;671;730;789;848;907;966;1025;1084;1143])=A22;
A([23;82;141;200;259;318;377;436;495;554;613;672;731;790;849;908;967;1026;1085;1144])=A23;
A([24;83;142;201;260;319;378;437;496;555;614;673;732;791;850;909;968;1027;1086;1145])=A24;
A([25;84;143;202;261;320;379;438;497;556;615;674;733;792;851;910;969;1028;1087;1146])=A25;
A([26;85;144;203;262;321;380;439;498;557;616;675;734;793;852;911;970;1029;1088;1147])=A26;
A([27;86;145;204;263;322;381;440;499;558;617;676;735;794;853;912;971;1030;1089;1148])=A27;
A([28;87;146;205;264;323;382;441;500;559;618;677;736;795;854;913;972;1031;1090;1149])=A28;
A([29;88;147;206;265;324;383;442;501;560;619;678;737;796;855;914;973;1032;1091;1150])=A29;
A([30;89;148;207;266;325;384;443;502;561;620;679;738;797;856;915;974;1033;1092;1151])=A30;
A([31;90;149;208;267;326;385;444;503;562;621;680;739;798;857;916;975;1034;1093;1152])=A31;
A([32;91;150;209;268;327;386;445;504;563;622;681;740;799;858;917;976;1035;1094;1153])=A32;
A([33;92;151;210;269;328;387;446;505;564;623;682;741;800;859;918;977;1036;1095;1154])=A33;
A([34;93;152;211;270;329;388;447;506;565;624;683;742;801;860;919;978;1037;1096;1155])=A34;
A([35;94;153;212;271;330;389;448;507;566;625;684;743;802;861;920;979;1038;1097;1156])=A35;
A([36;95;154;213;272;331;390;449;508;567;626;685;744;803;862;921;980;1039;1098;1157])=A36;
A([37;96;155;214;273;332;391;450;509;568;627;686;745;804;863;922;981;1040;1099;1158])=A37;
A([38;97;156;215;274;333;392;451;510;569;628;687;746;805;864;923;982;1041;1100;1159])=A38;
A([39;98;157;216;275;334;393;452;511;570;629;688;747;806;865;924;983;1042;1101;1160])=A39;
A([40;99;158;217;276;335;394;453;512;571;630;689;748;807;866;925;984;1043;1102;1161])=A40;
A([41;100;159;218;277;336;395;454;513;572;631;690;749;808;867;926;985;1044;1103;1162])=A41;
A([42;101;160;219;278;337;396;455;514;573;632;691;750;809;868;927;986;1045;1104;1163])=A42;
A([43;102;161;220;279;338;397;456;515;574;633;692;751;810;869;928;987;1046;1105;1164])=A43;
A([44;103;162;221;280;339;398;457;516;575;634;693;752;811;870;929;988;1047;1106;1165])=A44;
A([45;104;163;222;281;340;399;458;517;576;635;694;753;812;871;930;989;1048;1107;1166])=A45;
A([46;105;164;223;282;341;400;459;518;577;636;695;754;813;872;931;990;1049;1108;1167])=A46;
A([47;106;165;224;283;342;401;460;519;578;637;696;755;814;873;932;991;1050;1109;1168])=A47;
A([48;107;166;225;284;343;402;461;520;579;638;697;756;815;874;933;992;1051;1110;1169])=A48;
A([49;108;167;226;285;344;403;462;521;580;639;698;757;816;875;934;993;1052;1111;1170])=A49;
A([50;109;168;227;286;345;404;463;522;581;640;699;758;817;876;935;994;1053;1112;1171])=A50;
A([51;110;169;228;287;346;405;464;523;582;641;700;759;818;877;936;995;1054;1113;1172])=A51;
A([52;111;170;229;288;347;406;465;524;583;642;701;760;819;878;937;996;1055;1114;1173])=A52;
A([53;112;171;230;289;348;407;466;525;584;643;702;761;820;879;938;997;1056;1115;1174])=A53;
A([54;113;172;231;290;349;408;467;526;585;644;703;762;821;880;939;998;1057;1116;1175])=A54;
A([55;114;173;232;291;350;409;468;527;586;645;704;763;822;881;940;999;1058;1117;1176])=A55;
A([56;115;174;233;292;351;410;469;528;587;646;705;764;823;882;941;1000;1059;1118;1177])=A56;
A([57;116;175;234;293;352;411;470;529;588;647;706;765;824;883;942;1001;1060;1119;1178])=A57;
A([58;117;176;235;294;353;412;471;530;589;648;707;766;825;884;943;1002;1061;1120;1179])=A58;
A([59;118;177;236;295;354;413;472;531;590;649;708;767;826;885;944;1003;1062;1121;1180])=A59;


% number of elements
num_ele = 1180;
% elements nodes
ele_nod = [1	2	;
            1	11	;
            1	20	;
            1	21	;
            1	40	;
            2	3	;
            2	11	;
            2	12	;
            2	20	;
            2	22	;
            3	4	;
            3	12	;
            3	13	;
            3	23	;
            4	5	;
            4	13	;
            4	14	;
            4	24	;
            5	6	;
            5	14	;
            5	15	;
            5	25	;
            6	7	;
            6	15	;
            6	16	;
            6	26	;
            7	8	;
            7	16	;
            7	17	;
            7	27	;
            8	9	;
            8	17	;
            8	18	;
            8	28	;
            9	10	;
            9	18	;
            9	19	;
            9	29	;
            10	19	;
            10	30	;
            11	21	;
            11	22	;
            12	22	;
            12	23	;
            13	23	;
            13	24	;
            14	24	;
            14	25	;
            15	25	;
            15	26	;
            16	26	;
            16	27	;
            17	27	;
            17	28	;
            18	28	;
            18	29	;
            19	29	;
            19	30	;
            20	40	;
            21	22	;
            21	31	;
            21	40	;
            21	41	;
            21	60	;
            22	23	;
            22	31	;
            22	32	;
            22	40	;
            22	42	;
            23	24	;
            23	32	;
            23	33	;
            23	43	;
            24	25	;
            24	33	;
            24	34	;
            24	44	;
            25	26	;
            25	34	;
            25	35	;
            25	45	;
            26	27	;
            26	35	;
            26	36	;
            26	46	;
            27	28	;
            27	36	;
            27	37	;
            27	47	;
            28	29	;
            28	37	;
            28	38	;
            28	48	;
            29	30	;
            29	38	;
            29	39	;
            29	49	;
            30	39	;
            30	50	;
            31	41	;
            31	42	;
            32	42	;
            32	43	;
            33	43	;
            33	44	;
            34	44	;
            34	45	;
            35	45	;
            35	46	;
            36	46	;
            36	47	;
            37	47	;
            37	48	;
            38	48	;
            38	49	;
            39	49	;
            39	50	;
            40	60	;
            41	42	;
            41	51	;
            41	60	;
            41	61	;
            41	80	;
            42	43	;
            42	51	;
            42	52	;
            42	60	;
            42	62	;
            43	44	;
            43	52	;
            43	53	;
            43	63	;
            44	45	;
            44	53	;
            44	54	;
            44	64	;
            45	46	;
            45	54	;
            45	55	;
            45	65	;
            46	47	;
            46	55	;
            46	56	;
            46	66	;
            47	48	;
            47	56	;
            47	57	;
            47	67	;
            48	49	;
            48	57	;
            48	58	;
            48	68	;
            49	50	;
            49	58	;
            49	59	;
            49	69	;
            50	59	;
            50	70	;
            51	61	;
            51	62	;
            52	62	;
            52	63	;
            53	63	;
            53	64	;
            54	64	;
            54	65	;
            55	65	;
            55	66	;
            56	66	;
            56	67	;
            57	67	;
            57	68	;
            58	68	;
            58	69	;
            59	69	;
            59	70	;
            60	80	;
            61	62	;
            61	71	;
            61	80	;
            61	81	;
            61	100	;
            62	63	;
            62	71	;
            62	72	;
            62	80	;
            62	82	;
            63	64	;
            63	72	;
            63	73	;
            63	83	;
            64	65	;
            64	73	;
            64	74	;
            64	84	;
            65	66	;
            65	74	;
            65	75	;
            65	85	;
            66	67	;
            66	75	;
            66	76	;
            66	86	;
            67	68	;
            67	76	;
            67	77	;
            67	87	;
            68	69	;
            68	77	;
            68	78	;
            68	88	;
            69	70	;
            69	78	;
            69	79	;
            69	89	;
            70	79	;
            70	90	;
            71	81	;
            71	82	;
            72	82	;
            72	83	;
            73	83	;
            73	84	;
            74	84	;
            74	85	;
            75	85	;
            75	86	;
            76	86	;
            76	87	;
            77	87	;
            77	88	;
            78	88	;
            78	89	;
            79	89	;
            79	90	;
            80	100	;
            81	82	;
            81	91	;
            81	100	;
            81	101	;
            81	120	;
            82	83	;
            82	91	;
            82	92	;
            82	100	;
            82	102	;
            83	84	;
            83	92	;
            83	93	;
            83	103	;
            84	85	;
            84	93	;
            84	94	;
            84	104	;
            85	86	;
            85	94	;
            85	95	;
            85	105	;
            86	87	;
            86	95	;
            86	96	;
            86	106	;
            87	88	;
            87	96	;
            87	97	;
            87	107	;
            88	89	;
            88	97	;
            88	98	;
            88	108	;
            89	90	;
            89	98	;
            89	99	;
            89	109	;
            90	99	;
            90	110	;
            91	101	;
            91	102	;
            92	102	;
            92	103	;
            93	103	;
            93	104	;
            94	104	;
            94	105	;
            95	105	;
            95	106	;
            96	106	;
            96	107	;
            97	107	;
            97	108	;
            98	108	;
            98	109	;
            99	109	;
            99	110	;
            100	120	;
            101	102	;
            101	111	;
            101	120	;
            101	121	;
            101	140	;
            102	103	;
            102	111	;
            102	112	;
            102	120	;
            102	122	;
            103	104	;
            103	112	;
            103	113	;
            103	123	;
            104	105	;
            104	113	;
            104	114	;
            104	124	;
            105	106	;
            105	114	;
            105	115	;
            105	125	;
            106	107	;
            106	115	;
            106	116	;
            106	126	;
            107	108	;
            107	116	;
            107	117	;
            107	127	;
            108	109	;
            108	117	;
            108	118	;
            108	128	;
            109	110	;
            109	118	;
            109	119	;
            109	129	;
            110	119	;
            110	130	;
            111	121	;
            111	122	;
            112	122	;
            112	123	;
            113	123	;
            113	124	;
            114	124	;
            114	125	;
            115	125	;
            115	126	;
            116	126	;
            116	127	;
            117	127	;
            117	128	;
            118	128	;
            118	129	;
            119	129	;
            119	130	;
            120	140	;
            121	122	;
            121	131	;
            121	140	;
            121	141	;
            121	160	;
            122	123	;
            122	131	;
            122	132	;
            122	140	;
            122	142	;
            123	124	;
            123	132	;
            123	133	;
            123	143	;
            124	125	;
            124	133	;
            124	134	;
            124	144	;
            125	126	;
            125	134	;
            125	135	;
            125	145	;
            126	127	;
            126	135	;
            126	136	;
            126	146	;
            127	128	;
            127	136	;
            127	137	;
            127	147	;
            128	129	;
            128	137	;
            128	138	;
            128	148	;
            129	130	;
            129	138	;
            129	139	;
            129	149	;
            130	139	;
            130	150	;
            131	141	;
            131	142	;
            132	142	;
            132	143	;
            133	143	;
            133	144	;
            134	144	;
            134	145	;
            135	145	;
            135	146	;
            136	146	;
            136	147	;
            137	147	;
            137	148	;
            138	148	;
            138	149	;
            139	149	;
            139	150	;
            140	160	;
            141	142	;
            141	151	;
            141	160	;
            141	161	;
            141	180	;
            142	143	;
            142	151	;
            142	152	;
            142	160	;
            142	162	;
            143	144	;
            143	152	;
            143	153	;
            143	163	;
            144	145	;
            144	153	;
            144	154	;
            144	164	;
            145	146	;
            145	154	;
            145	155	;
            145	165	;
            146	147	;
            146	155	;
            146	156	;
            146	166	;
            147	148	;
            147	156	;
            147	157	;
            147	167	;
            148	149	;
            148	157	;
            148	158	;
            148	168	;
            149	150	;
            149	158	;
            149	159	;
            149	169	;
            150	159	;
            150	170	;
            151	161	;
            151	162	;
            152	162	;
            152	163	;
            153	163	;
            153	164	;
            154	164	;
            154	165	;
            155	165	;
            155	166	;
            156	166	;
            156	167	;
            157	167	;
            157	168	;
            158	168	;
            158	169	;
            159	169	;
            159	170	;
            160	180	;
            161	162	;
            161	171	;
            161	180	;
            161	181	;
            161	200	;
            162	163	;
            162	171	;
            162	172	;
            162	180	;
            162	182	;
            163	164	;
            163	172	;
            163	173	;
            163	183	;
            164	165	;
            164	173	;
            164	174	;
            164	184	;
            165	166	;
            165	174	;
            165	175	;
            165	185	;
            166	167	;
            166	175	;
            166	176	;
            166	186	;
            167	168	;
            167	176	;
            167	177	;
            167	187	;
            168	169	;
            168	177	;
            168	178	;
            168	188	;
            169	170	;
            169	178	;
            169	179	;
            169	189	;
            170	179	;
            170	190	;
            171	181	;
            171	182	;
            172	182	;
            172	183	;
            173	183	;
            173	184	;
            174	184	;
            174	185	;
            175	185	;
            175	186	;
            176	186	;
            176	187	;
            177	187	;
            177	188	;
            178	188	;
            178	189	;
            179	189	;
            179	190	;
            180	200	;
            181	182	;
            181	191	;
            181	200	;
            181	201	;
            181	220	;
            182	183	;
            182	191	;
            182	192	;
            182	200	;
            182	202	;
            183	184	;
            183	192	;
            183	193	;
            183	203	;
            184	185	;
            184	193	;
            184	194	;
            184	204	;
            185	186	;
            185	194	;
            185	195	;
            185	205	;
            186	187	;
            186	195	;
            186	196	;
            186	206	;
            187	188	;
            187	196	;
            187	197	;
            187	207	;
            188	189	;
            188	197	;
            188	198	;
            188	208	;
            189	190	;
            189	198	;
            189	199	;
            189	209	;
            190	199	;
            190	210	;
            191	201	;
            191	202	;
            192	202	;
            192	203	;
            193	203	;
            193	204	;
            194	204	;
            194	205	;
            195	205	;
            195	206	;
            196	206	;
            196	207	;
            197	207	;
            197	208	;
            198	208	;
            198	209	;
            199	209	;
            199	210	;
            200	220	;
            201	202	;
            201	211	;
            201	220	;
            201	221	;
            201	240	;
            202	203	;
            202	211	;
            202	212	;
            202	220	;
            202	222	;
            203	204	;
            203	212	;
            203	213	;
            203	223	;
            204	205	;
            204	213	;
            204	214	;
            204	224	;
            205	206	;
            205	214	;
            205	215	;
            205	225	;
            206	207	;
            206	215	;
            206	216	;
            206	226	;
            207	208	;
            207	216	;
            207	217	;
            207	227	;
            208	209	;
            208	217	;
            208	218	;
            208	228	;
            209	210	;
            209	218	;
            209	219	;
            209	229	;
            210	219	;
            210	230	;
            211	221	;
            211	222	;
            212	222	;
            212	223	;
            213	223	;
            213	224	;
            214	224	;
            214	225	;
            215	225	;
            215	226	;
            216	226	;
            216	227	;
            217	227	;
            217	228	;
            218	228	;
            218	229	;
            219	229	;
            219	230	;
            220	240	;
            221	222	;
            221	231	;
            221	240	;
            221	241	;
            221	260	;
            222	223	;
            222	231	;
            222	232	;
            222	240	;
            222	242	;
            223	224	;
            223	232	;
            223	233	;
            223	243	;
            224	225	;
            224	233	;
            224	234	;
            224	244	;
            225	226	;
            225	234	;
            225	235	;
            225	245	;
            226	227	;
            226	235	;
            226	236	;
            226	246	;
            227	228	;
            227	236	;
            227	237	;
            227	247	;
            228	229	;
            228	237	;
            228	238	;
            228	248	;
            229	230	;
            229	238	;
            229	239	;
            229	249	;
            230	239	;
            230	250	;
            231	241	;
            231	242	;
            232	242	;
            232	243	;
            233	243	;
            233	244	;
            234	244	;
            234	245	;
            235	245	;
            235	246	;
            236	246	;
            236	247	;
            237	247	;
            237	248	;
            238	248	;
            238	249	;
            239	249	;
            239	250	;
            240	260	;
            241	242	;
            241	251	;
            241	260	;
            241	261	;
            241	280	;
            242	243	;
            242	251	;
            242	252	;
            242	260	;
            242	262	;
            243	244	;
            243	252	;
            243	253	;
            243	263	;
            244	245	;
            244	253	;
            244	254	;
            244	264	;
            245	246	;
            245	254	;
            245	255	;
            245	265	;
            246	247	;
            246	255	;
            246	256	;
            246	266	;
            247	248	;
            247	256	;
            247	257	;
            247	267	;
            248	249	;
            248	257	;
            248	258	;
            248	268	;
            249	250	;
            249	258	;
            249	259	;
            249	269	;
            250	259	;
            250	270	;
            251	261	;
            251	262	;
            252	262	;
            252	263	;
            253	263	;
            253	264	;
            254	264	;
            254	265	;
            255	265	;
            255	266	;
            256	266	;
            256	267	;
            257	267	;
            257	268	;
            258	268	;
            258	269	;
            259	269	;
            259	270	;
            260	280	;
            261	262	;
            261	271	;
            261	280	;
            261	281	;
            261	300	;
            262	263	;
            262	271	;
            262	272	;
            262	280	;
            262	282	;
            263	264	;
            263	272	;
            263	273	;
            263	283	;
            264	265	;
            264	273	;
            264	274	;
            264	284	;
            265	266	;
            265	274	;
            265	275	;
            265	285	;
            266	267	;
            266	275	;
            266	276	;
            266	286	;
            267	268	;
            267	276	;
            267	277	;
            267	287	;
            268	269	;
            268	277	;
            268	278	;
            268	288	;
            269	270	;
            269	278	;
            269	279	;
            269	289	;
            270	279	;
            270	290	;
            271	281	;
            271	282	;
            272	282	;
            272	283	;
            273	283	;
            273	284	;
            274	284	;
            274	285	;
            275	285	;
            275	286	;
            276	286	;
            276	287	;
            277	287	;
            277	288	;
            278	288	;
            278	289	;
            279	289	;
            279	290	;
            280	300	;
            281	282	;
            281	291	;
            281	300	;
            281	301	;
            281	320	;
            282	283	;
            282	291	;
            282	292	;
            282	300	;
            282	302	;
            283	284	;
            283	292	;
            283	293	;
            283	303	;
            284	285	;
            284	293	;
            284	294	;
            284	304	;
            285	286	;
            285	294	;
            285	295	;
            285	305	;
            286	287	;
            286	295	;
            286	296	;
            286	306	;
            287	288	;
            287	296	;
            287	297	;
            287	307	;
            288	289	;
            288	297	;
            288	298	;
            288	308	;
            289	290	;
            289	298	;
            289	299	;
            289	309	;
            290	299	;
            290	310	;
            291	301	;
            291	302	;
            292	302	;
            292	303	;
            293	303	;
            293	304	;
            294	304	;
            294	305	;
            295	305	;
            295	306	;
            296	306	;
            296	307	;
            297	307	;
            297	308	;
            298	308	;
            298	309	;
            299	309	;
            299	310	;
            300	320	;
            301	302	;
            301	311	;
            301	320	;
            301	321	;
            301	340	;
            302	303	;
            302	311	;
            302	312	;
            302	320	;
            302	322	;
            303	304	;
            303	312	;
            303	313	;
            303	323	;
            304	305	;
            304	313	;
            304	314	;
            304	324	;
            305	306	;
            305	314	;
            305	315	;
            305	325	;
            306	307	;
            306	315	;
            306	316	;
            306	326	;
            307	308	;
            307	316	;
            307	317	;
            307	327	;
            308	309	;
            308	317	;
            308	318	;
            308	328	;
            309	310	;
            309	318	;
            309	319	;
            309	329	;
            310	319	;
            310	330	;
            311	321	;
            311	322	;
            312	322	;
            312	323	;
            313	323	;
            313	324	;
            314	324	;
            314	325	;
            315	325	;
            315	326	;
            316	326	;
            316	327	;
            317	327	;
            317	328	;
            318	328	;
            318	329	;
            319	329	;
            319	330	;
            320	340	;
            321	322	;
            321	331	;
            321	340	;
            321	341	;
            321	360	;
            322	323	;
            322	331	;
            322	332	;
            322	340	;
            322	342	;
            323	324	;
            323	332	;
            323	333	;
            323	343	;
            324	325	;
            324	333	;
            324	334	;
            324	344	;
            325	326	;
            325	334	;
            325	335	;
            325	345	;
            326	327	;
            326	335	;
            326	336	;
            326	346	;
            327	328	;
            327	336	;
            327	337	;
            327	347	;
            328	329	;
            328	337	;
            328	338	;
            328	348	;
            329	330	;
            329	338	;
            329	339	;
            329	349	;
            330	339	;
            330	350	;
            331	341	;
            331	342	;
            332	342	;
            332	343	;
            333	343	;
            333	344	;
            334	344	;
            334	345	;
            335	345	;
            335	346	;
            336	346	;
            336	347	;
            337	347	;
            337	348	;
            338	348	;
            338	349	;
            339	349	;
            339	350	;
            340	360	;
            341	342	;
            341	351	;
            341	360	;
            341	361	;
            341	380	;
            342	343	;
            342	351	;
            342	352	;
            342	360	;
            342	362	;
            343	344	;
            343	352	;
            343	353	;
            343	363	;
            344	345	;
            344	353	;
            344	354	;
            344	364	;
            345	346	;
            345	354	;
            345	355	;
            345	365	;
            346	347	;
            346	355	;
            346	356	;
            346	366	;
            347	348	;
            347	356	;
            347	357	;
            347	367	;
            348	349	;
            348	357	;
            348	358	;
            348	368	;
            349	350	;
            349	358	;
            349	359	;
            349	369	;
            350	359	;
            350	370	;
            351	361	;
            351	362	;
            352	362	;
            352	363	;
            353	363	;
            353	364	;
            354	364	;
            354	365	;
            355	365	;
            355	366	;
            356	366	;
            356	367	;
            357	367	;
            357	368	;
            358	368	;
            358	369	;
            359	369	;
            359	370	;
            360	380	;
            361	362	;
            361	371	;
            361	380	;
            361	381	;
            361	400	;
            362	363	;
            362	371	;
            362	372	;
            362	380	;
            362	382	;
            363	364	;
            363	372	;
            363	373	;
            363	383	;
            364	365	;
            364	373	;
            364	374	;
            364	384	;
            365	366	;
            365	374	;
            365	375	;
            365	385	;
            366	367	;
            366	375	;
            366	376	;
            366	386	;
            367	368	;
            367	376	;
            367	377	;
            367	387	;
            368	369	;
            368	377	;
            368	378	;
            368	388	;
            369	370	;
            369	378	;
            369	379	;
            369	389	;
            370	379	;
            370	390	;
            371	381	;
            371	382	;
            372	382	;
            372	383	;
            373	383	;
            373	384	;
            374	384	;
            374	385	;
            375	385	;
            375	386	;
            376	386	;
            376	387	;
            377	387	;
            377	388	;
            378	388	;
            378	389	;
            379	389	;
            379	390	;
            380	400	;
            381	382	;
            381	391	;
            381	400	;
            381	1	;
            381	20	;
            382	383	;
            382	391	;
            382	392	;
            382	400	;
            382	2	;
            383	384	;
            383	392	;
            383	393	;
            383	3	;
            384	385	;
            384	393	;
            384	394	;
            384	4	;
            385	386	;
            385	394	;
            385	395	;
            385	5	;
            386	387	;
            386	395	;
            386	396	;
            386	6	;
            387	388	;
            387	396	;
            387	397	;
            387	7	;
            388	389	;
            388	397	;
            388	398	;
            388	8	;
            389	390	;
            389	398	;
            389	399	;
            389	9	;
            390	399	;
            390	10	;
            391	1	;
            391	2	;
            392	2	;
            392	3	;
            393	3	;
            393	4	;
            394	4	;
            394	5	;
            395	5	;
            395	6	;
            396	6	;
            396	7	;
            397	7	;
            397	8	;
            398	8	;
            398	9	;
            399	9	;
            399	10	;
            400	20	
            ];
% number of nodes
num_nod = 400;
% nodes coordinates
nod_coor = [3.1181	0	14.6723	;
6.1013	0	13.7031	;
8.8166	0	12.1354	;
11.1476	0	10.0365	;
12.9904	0	7.5	;
14.2657	0	5.16074	;
14.9179	0	1.5676	;
14.9179	0	-1.5677	;
14.2657	0	-4.6359	;
12.9903	0	-7.5001	;
4.5788	0.7252	14.2657	;
7.4077	1.1733	12.9904	;
9.913	1.5701	11.1476	;
11.986	1.8984	8.8165	;
13.5344	2.1436	6.1013	;
14.4917	2.2953	3.118	;
14.8153	2.3465	0	;
14.4917	2.2953	-3.1181	;
13.5343	2.1436	-6.1014	;
3.1181	0	13.7031	;
2.96549	0.96355	14.6723	;
5.80268	1.88541	13.7031	;
8.38508	2.72448	12.1354	;
10.602	3.4448	10.0365	;
12.3546	4.01425	7.5	;
13.56749	4.40834	5.16074	;
14.18777	4.60988	1.5676	;
14.18777	4.60988	-1.5677	;
13.56749	4.40834	-4.6359	;
12.35451	4.01422	-7.5001	;
4.1306	2.10463	14.2657	;
6.68257	3.40498	12.9904	;
8.94264	4.55654	11.1476	;
10.81273	5.50936	8.8165	;
12.20957	6.22104	6.1013	;
13.07314	6.66114	3.118	;
13.36508	6.80983	0	;
13.07314	6.66114	-3.1181	;
12.20948	6.22101	-6.1014	;
2.96549	0.96355	13.7031	;
2.5226	1.83277	14.6723	;
4.93606	3.58625	13.7031	;
7.13278	5.18227	12.1354	;
9.0186	6.55239	10.0365	;
10.50945	7.63557	7.5	;
11.54119	8.38517	5.16074	;
12.06883	8.76852	1.5676	;
12.06883	8.76852	-1.5677	;
11.54119	8.38517	-4.6359	;
10.50937	7.63551	-7.5001	;
3.27807	3.27805	14.2657	;
5.30331	5.30336	12.9904	;
7.0969	7.09695	11.1476	;
8.58103	8.58103	8.8165	;
9.68958	9.68953	6.1013	;
10.37489	10.37494	3.118	;
10.60659	10.60657	0	;
10.37489	10.37494	-3.1181	;
9.6895	9.68947	-6.1014	;
2.5226	1.83277	13.7031	;
1.83277	2.5226	14.6723	;
3.58625	4.93606	13.7031	;
5.18227	7.13278	12.1354	;
6.55239	9.0186	10.0365	;
7.63557	10.50945	7.5	;
8.38517	11.54119	5.16074	;
8.76852	12.06883	1.5676	;
8.76852	12.06883	-1.5677	;
8.38517	11.54119	-4.6359	;
7.63551	10.50937	-7.5001	;
2.10465	4.13059	14.2657	;
3.40492	6.6826	12.9904	;
4.55648	8.94267	11.1476	;
5.50936	10.81273	8.8165	;
6.22111	12.20954	6.1013	;
6.66107	13.07318	3.118	;
6.80986	13.36507	0	;
6.66107	13.07318	-3.1181	;
6.22105	12.20946	-6.1014	;
1.83277	2.5226	13.7031	;
0.96355	2.96549	14.6723	;
1.88541	5.80268	13.7031	;
2.72448	8.38508	12.1354	;
3.4448	10.602	10.0365	;
4.01425	12.3546	7.5	;
4.40834	13.56749	5.16074	;
4.60988	14.18777	1.5676	;
4.60988	14.18777	-1.5677	;
4.40834	13.56749	-4.6359	;
4.01422	12.35451	-7.5001	;
0.72522	4.5788	14.2657	;
1.17323	7.40771	12.9904	;
1.57003	9.91301	11.1476	;
1.89839	11.986	8.8165	;
2.14367	13.53439	6.1013	;
2.29522	14.49171	3.118	;
2.34653	14.8153	0	;
2.29522	14.49171	-3.1181	;
2.14364	13.53429	-6.1014	;
0.96355	2.96549	13.7031	;
1.909E-16	3.1181	14.6723	;
3.736E-16	6.1013	13.7031	;
5.398E-16	8.8166	12.1354	;
6.826E-16	11.1476	10.0365	;
7.954E-16	12.9904	7.5	;
8.735E-16	14.2657	5.16074	;
9.134E-16	14.9179	1.5676	;
9.134E-16	14.9179	-1.5677	;
8.735E-16	14.2657	-4.6359	;
7.954E-16	12.9903	-7.5001	;
-0.7252	4.5788	14.2657	;
-1.1733	7.4077	12.9904	;
-1.5701	9.913	11.1476	;
-1.8984	11.986	8.8165	;
-2.1436	13.5344	6.1013	;
-2.2953	14.4917	3.118	;
-2.3465	14.8153	0	;
-2.2953	14.4917	-3.1181	;
-2.1436	13.5343	-6.1014	;
1.909E-16	3.1181	13.7031	;
-0.96355	2.96549	14.6723	;
-1.88541	5.80268	13.7031	;
-2.72448	8.38508	12.1354	;
-3.4448	10.602	10.0365	;
-4.01425	12.3546	7.5	;
-4.40834	13.56749	5.16074	;
-4.60988	14.18777	1.5676	;
-4.60988	14.18777	-1.5677	;
-4.40834	13.56749	-4.6359	;
-4.01422	12.35451	-7.5001	;
-2.10463	4.1306	14.2657	;
-3.40498	6.68257	12.9904	;
-4.55654	8.94264	11.1476	;
-5.50936	10.81273	8.8165	;
-6.22104	12.20957	6.1013	;
-6.66114	13.07314	3.118	;
-6.80983	13.36508	0	;
-6.66114	13.07314	-3.1181	;
-6.22101	12.20948	-6.1014	;
-0.96355	2.96549	13.7031	;
-1.83277	2.5226	14.6723	;
-3.58625	4.93606	13.7031	;
-5.18227	7.13278	12.1354	;
-6.55239	9.0186	10.0365	;
-7.63557	10.50945	7.5	;
-8.38517	11.54119	5.16074	;
-8.76852	12.06883	1.5676	;
-8.76852	12.06883	-1.5677	;
-8.38517	11.54119	-4.6359	;
-7.63551	10.50937	-7.5001	;
-3.27805	3.27807	14.2657	;
-5.30336	5.30331	12.9904	;
-7.09695	7.0969	11.1476	;
-8.58103	8.58103	8.8165	;
-9.68953	9.68958	6.1013	;
-10.37494	10.37489	3.118	;
-10.60657	10.60659	0	;
-10.37494	10.37489	-3.1181	;
-9.68947	9.6895	-6.1014	;
-1.83277	2.5226	13.7031	;
-2.5226	1.83277	14.6723	;
-4.93606	3.58625	13.7031	;
-7.13278	5.18227	12.1354	;
-9.0186	6.55239	10.0365	;
-10.50945	7.63557	7.5	;
-11.54119	8.38517	5.16074	;
-12.06883	8.76852	1.5676	;
-12.06883	8.76852	-1.5677	;
-11.54119	8.38517	-4.6359	;
-10.50937	7.63551	-7.5001	;
-4.13059	2.10465	14.2657	;
-6.6826	3.40492	12.9904	;
-8.94267	4.55648	11.1476	;
-10.81273	5.50936	8.8165	;
-12.20954	6.22111	6.1013	;
-13.07318	6.66107	3.118	;
-13.36507	6.80986	0	;
-13.07318	6.66107	-3.1181	;
-12.20946	6.22105	-6.1014	;
-2.5226	1.83277	13.7031	;
-2.96549	0.96355	14.6723	;
-5.80268	1.88541	13.7031	;
-8.38508	2.72448	12.1354	;
-10.602	3.4448	10.0365	;
-12.3546	4.01425	7.5	;
-13.56749	4.40834	5.16074	;
-14.18777	4.60988	1.5676	;
-14.18777	4.60988	-1.5677	;
-13.56749	4.40834	-4.6359	;
-12.35451	4.01422	-7.5001	;
-4.5788	0.72522	14.2657	;
-7.40771	1.17323	12.9904	;
-9.91301	1.57003	11.1476	;
-11.986	1.89839	8.8165	;
-13.53439	2.14367	6.1013	;
-14.49171	2.29522	3.118	;
-14.8153	2.34653	0	;
-14.49171	2.29522	-3.1181	;
-13.53429	2.14364	-6.1014	;
-2.96549	0.96355	13.7031	;
-3.1181	3.818E-16	14.6723	;
-6.1013	7.472E-16	13.7031	;
-8.8166	1.08E-15	12.1354	;
-11.1476	1.365E-15	10.0365	;
-12.9904	1.591E-15	7.5	;
-14.2657	1.747E-15	5.16074	;
-14.9179	1.827E-15	1.5676	;
-14.9179	1.827E-15	-1.5677	;
-14.2657	1.747E-15	-4.6359	;
-12.9903	1.591E-15	-7.5001	;
-4.5788	-0.7252	14.2657	;
-7.4077	-1.1733	12.9904	;
-9.913	-1.5701	11.1476	;
-11.986	-1.8984	8.8165	;
-13.5344	-2.1436	6.1013	;
-14.4917	-2.2953	3.118	;
-14.8153	-2.3465	0	;
-14.4917	-2.2953	-3.1181	;
-13.5343	-2.1436	-6.1014	;
-3.1181	3.818E-16	13.7031	;
-2.96549	-0.96355	14.6723	;
-5.80268	-1.88541	13.7031	;
-8.38508	-2.72448	12.1354	;
-10.602	-3.4448	10.0365	;
-12.3546	-4.01425	7.5	;
-13.56749	-4.40834	5.16074	;
-14.18777	-4.60988	1.5676	;
-14.18777	-4.60988	-1.5677	;
-13.56749	-4.40834	-4.6359	;
-12.35451	-4.01422	-7.5001	;
-4.1306	-2.10463	14.2657	;
-6.68257	-3.40498	12.9904	;
-8.94264	-4.55654	11.1476	;
-10.81273	-5.50936	8.8165	;
-12.20957	-6.22104	6.1013	;
-13.07314	-6.66114	3.118	;
-13.36508	-6.80983	0	;
-13.07314	-6.66114	-3.1181	;
-12.20948	-6.22101	-6.1014	;
-2.96549	-0.96355	13.7031	;
-2.5226	-1.83277	14.6723	;
-4.93606	-3.58625	13.7031	;
-7.13278	-5.18227	12.1354	;
-9.0186	-6.55239	10.0365	;
-10.50945	-7.63557	7.5	;
-11.54119	-8.38517	5.16074	;
-12.06883	-8.76852	1.5676	;
-12.06883	-8.76852	-1.5677	;
-11.54119	-8.38517	-4.6359	;
-10.50937	-7.63551	-7.5001	;
-3.27807	-3.27805	14.2657	;
-5.30331	-5.30336	12.9904	;
-7.0969	-7.09695	11.1476	;
-8.58103	-8.58103	8.8165	;
-9.68958	-9.68953	6.1013	;
-10.37489	-10.37494	3.118	;
-10.60659	-10.60657	0	;
-10.37489	-10.37494	-3.1181	;
-9.6895	-9.68947	-6.1014	;
-2.5226	-1.83277	13.7031	;
-1.83277	-2.5226	14.6723	;
-3.58625	-4.93606	13.7031	;
-5.18227	-7.13278	12.1354	;
-6.55239	-9.0186	10.0365	;
-7.63557	-10.50945	7.5	;
-8.38517	-11.54119	5.16074	;
-8.76852	-12.06883	1.5676	;
-8.76852	-12.06883	-1.5677	;
-8.38517	-11.54119	-4.6359	;
-7.63551	-10.50937	-7.5001	;
-2.10465	-4.13059	14.2657	;
-3.40492	-6.6826	12.9904	;
-4.55648	-8.94267	11.1476	;
-5.50936	-10.81273	8.8165	;
-6.22111	-12.20954	6.1013	;
-6.66107	-13.07318	3.118	;
-6.80986	-13.36507	0	;
-6.66107	-13.07318	-3.1181	;
-6.22105	-12.20946	-6.1014	;
-1.83277	-2.5226	13.7031	;
-0.96355	-2.96549	14.6723	;
-1.88541	-5.80268	13.7031	;
-2.72448	-8.38508	12.1354	;
-3.4448	-10.602	10.0365	;
-4.01425	-12.3546	7.5	;
-4.40834	-13.56749	5.16074	;
-4.60988	-14.18777	1.5676	;
-4.60988	-14.18777	-1.5677	;
-4.40834	-13.56749	-4.6359	;
-4.01422	-12.35451	-7.5001	;
-0.72522	-4.5788	14.2657	;
-1.17323	-7.40771	12.9904	;
-1.57003	-9.91301	11.1476	;
-1.89839	-11.986	8.8165	;
-2.14367	-13.53439	6.1013	;
-2.29522	-14.49171	3.118	;
-2.34653	-14.8153	0	;
-2.29522	-14.49171	-3.1181	;
-2.14364	-13.53429	-6.1014	;
-0.96355	-2.96549	13.7031	;
-5.728E-16	-3.1181	14.6723	;
-1.121E-15	-6.1013	13.7031	;
-1.62E-15	-8.8166	12.1354	;
-2.048E-15	-11.1476	10.0365	;
-2.386E-15	-12.9904	7.5	;
-2.62E-15	-14.2657	5.16074	;
-2.74E-15	-14.9179	1.5676	;
-2.74E-15	-14.9179	-1.5677	;
-2.62E-15	-14.2657	-4.6359	;
-2.386E-15	-12.9903	-7.5001	;
0.7252	-4.5788	14.2657	;
1.1733	-7.4077	12.9904	;
1.5701	-9.913	11.1476	;
1.8984	-11.986	8.8165	;
2.1436	-13.5344	6.1013	;
2.2953	-14.4917	3.118	;
2.3465	-14.8153	0	;
2.2953	-14.4917	-3.1181	;
2.1436	-13.5343	-6.1014	;
-5.728E-16	-3.1181	13.7031	;
0.96355	-2.96549	14.6723	;
1.88541	-5.80268	13.7031	;
2.72448	-8.38508	12.1354	;
3.4448	-10.602	10.0365	;
4.01425	-12.3546	7.5	;
4.40834	-13.56749	5.16074	;
4.60988	-14.18777	1.5676	;
4.60988	-14.18777	-1.5677	;
4.40834	-13.56749	-4.6359	;
4.01422	-12.35451	-7.5001	;
2.10463	-4.1306	14.2657	;
3.40498	-6.68257	12.9904	;
4.55654	-8.94264	11.1476	;
5.50936	-10.81273	8.8165	;
6.22104	-12.20957	6.1013	;
6.66114	-13.07314	3.118	;
6.80983	-13.36508	0	;
6.66114	-13.07314	-3.1181	;
6.22101	-12.20948	-6.1014	;
0.96355	-2.96549	13.7031	;
1.83277	-2.5226	14.6723	;
3.58625	-4.93606	13.7031	;
5.18227	-7.13278	12.1354	;
6.55239	-9.0186	10.0365	;
7.63557	-10.50945	7.5	;
8.38517	-11.54119	5.16074	;
8.76852	-12.06883	1.5676	;
8.76852	-12.06883	-1.5677	;
8.38517	-11.54119	-4.6359	;
7.63551	-10.50937	-7.5001	;
3.27805	-3.27807	14.2657	;
5.30336	-5.30331	12.9904	;
7.09695	-7.0969	11.1476	;
8.58103	-8.58103	8.8165	;
9.68953	-9.68958	6.1013	;
10.37494	-10.37489	3.118	;
10.60657	-10.60659	0	;
10.37494	-10.37489	-3.1181	;
9.68947	-9.6895	-6.1014	;
1.83277	-2.5226	13.7031	;
2.5226	-1.83277	14.6723	;
4.93606	-3.58625	13.7031	;
7.13278	-5.18227	12.1354	;
9.0186	-6.55239	10.0365	;
10.50945	-7.63557	7.5	;
11.54119	-8.38517	5.16074	;
12.06883	-8.76852	1.5676	;
12.06883	-8.76852	-1.5677	;
11.54119	-8.38517	-4.6359	;
10.50937	-7.63551	-7.5001	;
4.13059	-2.10465	14.2657	;
6.6826	-3.40492	12.9904	;
8.94267	-4.55648	11.1476	;
10.81273	-5.50936	8.8165	;
12.20954	-6.22111	6.1013	;
13.07318	-6.66107	3.118	;
13.36507	-6.80986	0	;
13.07318	-6.66107	-3.1181	;
12.20946	-6.22105	-6.1014	;
2.5226	-1.83277	13.7031	;
2.96549	-0.96355	14.6723	;
5.80268	-1.88541	13.7031	;
8.38508	-2.72448	12.1354	;
10.602	-3.4448	10.0365	;
12.3546	-4.01425	7.5	;
13.56749	-4.40834	5.16074	;
14.18777	-4.60988	1.5676	;
14.18777	-4.60988	-1.5677	;
13.56749	-4.40834	-4.6359	;
12.35451	-4.01422	-7.5001	;
4.5788	-0.72522	14.2657	;
7.40771	-1.17323	12.9904	;
9.91301	-1.57003	11.1476	;
11.986	-1.89839	8.8165	;
13.53439	-2.14367	6.1013	;
14.49171	-2.29522	3.118	;
14.8153	-2.34653	0	;
14.49171	-2.29522	-3.1181	;
13.53429	-2.14364	-6.1014	;
2.96549	-0.96355	13.7031	
    ];

dofPerNode = 3;
num_dof = num_nod*dofPerNode;
dof = 1:num_dof;

% calculate K and M
dofPerNode = 3;  % number of degree of freedom of one node
num_dof    = num_nod*dofPerNode; % total dgree of freedom of system
K = zeros(num_dof);
M = zeros(num_dof);
ele_dof = zeros(num_ele,6);
L = zeros(num_ele,1);
C = zeros(num_ele,3);
for ii=1:num_ele
   index1 = ele_nod(ii,1); 
   index2 = ele_nod(ii,2);
   dx = nod_coor(index2,1)-nod_coor(index1,1);
   dy = nod_coor(index2,2)-nod_coor(index1,2);
   dz = nod_coor(index2,3)-nod_coor(index1,3);
   % compute length of each bar
   L(ii) = sqrt(dx^2+dy^2+dz^2);
   C(ii,1) = dx/L(ii);
   C(ii,2) = dy/L(ii);
   C(ii,3) = dz/L(ii);
   ele_dof(ii,:) = [3*index1-2 3*index1-1 3*index1...
                    3*index2-2 3*index2-1 3*index2];
end
% Construct global stiffness matrix & Mass matrix
for ii = 1:num_ele
    index = ele_dof(ii,:);
    K(index,index) = K(index,index) + A(ii)*E/L(ii)*rotate3(C(ii,1),C(ii,2),C(ii,3)); % rotate() calls rotation matrix;
    M(index,index) = M(index,index) + rho*L(ii)*A(ii)*[2 0 0 1 0 0;0 2 0 0 1 0;0 0 2 0 0 1;1 0 0 2 0 0;0 1 0 0 2 0;0 0 1 0 0 2]/6;% lumped mass matrix
end

% Boundary and loading conditions
dof_constrnt = [28	29	30	88	89	90	148	149	150	...%sub1-3
                208 209	210	268	269	270	328	329	330	...%sub4-6
                388	389	390	448	449	450	508	509	510	...%sub7-9
                568	569	570	628	629	630	688	689	690	...%sub10-12
                748	749	750	808	809	810	868	869	870	...%sub13-15
                928	929	930	988	989	990	1048 1049 1050 ...%sub16-18
                1108	1109	1110	1168	1169	1170];%sub19-20
dof_active = setdiff(1:num_dof, dof_constrnt);
            %  1   2   3   4   5   6   7   8   9   10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27 282930 31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60
add_M = diag([100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;0;0;0;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;...%sub1
              100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;0;0;0;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;...%sub2
              100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;0;0;0;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;...%sub3
              100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;0;0;0;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;...%sub4
              100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;0;0;0;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;...%sub5
              100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;0;0;0;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;...%sub6
              100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;0;0;0;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;...%sub7
              100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;0;0;0;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;...%sub8
              100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;0;0;0;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;...%sub9
              100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;0;0;0;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;...%sub10
              100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;0;0;0;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;...%sub11
              100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;0;0;0;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;...%sub12
              100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;0;0;0;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;...%sub13
              100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;0;0;0;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;...%sub14
              100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;0;0;0;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;...%sub15
              100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;0;0;0;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;...%sub16
              100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;0;0;0;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;...%sub17
              100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;0;0;0;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;...%sub18
              100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;0;0;0;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;...%sub19
              100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;0;0;0;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100;100]); %sub20
for dof = 1:num_dof
   M(dof,dof) = M(dof,dof) + add_M(dof,dof);
end

% Calculate frequency 
[omega,~]=eigens(K,M,dof_constrnt); %eigens2s(K,M,dof_constrnt); 
f=sqrt(omega)/(2*pi);
% c11=f(1)
% c33=f(3)
c1 = 7/f(1) -1;
% c2 = 7/f(2)-1;
c3 = 9/f(3) -1;
% c4 = 9/f(4)-1;
% c5 = 9/f(5)-1;
c = [c1 c3]; %
ceq = [];

function [L, X] = eigens(K, M, dof_constrnt)
% PURPOSE
%  Solve the generalized eigenvalue problem
%  [K-LM]X = 0, considering boundary conditions.
%
% INPUT:
%    K : global stiffness matrix, dim(K)= ele_nod x ele_nod
%    M : global mass matrix, dim(M)= ele_nod x ele_nod
%    b : boundary condition matrix
%        dim(dof_active)= dof_active x 1
% OUTPUT:
%    L : eigenvalues stored in a vector with length (ele_nod - dof_active) 
%    X : eigenvectors dim(X)= ele_nod x num_dof, num_dof : number of dof's

  [ele_nod, ~] = size(K);
  dof = (1:ele_nod)';

  if nargin == 3
    dof_constrnt = dof_constrnt(:);
    dof(dof_constrnt) = []; 
    if nargout == 2
      [X1, D] = eig(K(dof, dof), M(dof, dof));
      d = diag(D);
      [L, ii] = sort(d);
      X2 = X1(:, ii);
      X = zeros(ele_nod, length(dof));
      X(dof, :) = X2;
      % Normalize eigenvectors
      for jj = 1:length(dof)
        mnorm = sqrt(X(:, jj)' * M * X(:, jj));
        X(:, jj) = X(:, jj) / mnorm;
      end
    else
      d = eigs(K(dof, dof), M(dof, dof));
      L = sort(d);
    end
  else
    if nargout == 2
      [X1, D] = eig(K, M);
      d = diag(D);
      [L, ii] = sort(d);
      X = X1(:, ii);
      % Normalize eigenvectors
      for jj = 1:ele_nod
        mnorm = sqrt(X(:, jj)' * M * X(:, jj));
        X(:, jj) = X(:, jj) / mnorm;
      end
    else
      d = eig(K, M);
      L = sort(d);
    end
  end
% function [L, X] = eigens(K, M, dof_constrnt)
%     % PURPOSE
%     %  Solve the generalized eigenvalue problem [K-LM]X = 0, considering boundary conditions.
%     %
%     % INPUT:
%     %    K : global stiffness matrix
%     %    M : global mass matrix
%     %    dof_constrnt : (optional) indices of constrained degrees of freedom
%     % OUTPUT:
%     %    L : eigenvalues 
%     %    X : eigenvectors 
% 
%     [ele_nod, ~] = size(K);
%     dof = (1:ele_nod)';
% 
%     if nargin == 3  % If boundary conditions are provided
%         dof_constrnt = dof_constrnt(:);
%         dof(dof_constrnt) = [];  
%         K = K(dof, dof);  
%         M = M(dof, dof);
%     end
% 
%     if nargout == 2  % If both eigenvalues and eigenvectors are requested
% 
%         if ele_nod > 1000
%             opts.issym = true;
%             [X, D] = eigs(K, M, ele_nod - numel(dof_constrnt), 'sm', opts); 
%         else
%             [X, D] = eig(K, M); 
%         end
% 
%         L = diag(D);
%         [L, ii] = sort(L);
%         X = X(:, ii);
% 
%         mnorm = sqrt(sum(X .* (M * X), 1)); 
%         X = X ./ mnorm; 
% 
%         if nargin == 3  % Expand X if boundary conditions were given
%             X_full = zeros(ele_nod, size(X, 2));
%             X_full(dof, :) = X;
%             X = X_full;
%         end
%     else
%         if ele_nod > 1000
%             opts.issym = true;
%             L = eigs(K, M, ele_nod - numel(dof_constrnt), 'sm', opts);
%         else
%             L = eig(K, M); 
%         end
%         L = sort(L);
%     end
% %end